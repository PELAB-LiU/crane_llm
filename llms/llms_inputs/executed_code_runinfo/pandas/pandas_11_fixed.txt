# Executed Cells:
## Cell 1:



import numpy as np
import pandas as pd
import tensorflow as tf
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.manifold import TSNE
from sklearn.decomposition import PCA, TruncatedSVD
import matplotlib.patches as mpatches
import time
import plotly.figure_factory as ff
from plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot


from sklearn.linear_model import LogisticRegression
from sklearn.svm import SVC
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
import collections



from sklearn.model_selection import train_test_split
from sklearn.pipeline import make_pipeline
from imblearn.pipeline import make_pipeline as imbalanced_make_pipeline
from imblearn.over_sampling import SMOTE
from imblearn.under_sampling import NearMiss
from imblearn.metrics import classification_report_imbalanced
from sklearn.metrics import precision_score, recall_score, f1_score, roc_auc_score, accuracy_score, classification_report
from collections import Counter
from sklearn.model_selection import KFold, StratifiedKFold
import warnings
warnings.filterwarnings("ignore")


## Cell 2:

df = pd.read_csv('data/creditcard.csv')
df.head()

## Cell 3:

data_df = df.copy()
data_df['Hour'] = data_df['Time'].apply(lambda x: np.floor(x / 3600))

tmp = data_df.groupby(['Hour', 'Class'])['Amount'].aggregate(['min', 'max', 'count', 'sum', 'mean', 'median', 'var']).reset_index()
data_df_1 = pd.DataFrame(tmp)
data_df_1.columns = ['Hour', 'Class', 'Min', 'Max', 'Transactions', 'Sum', 'Mean', 'Median', 'Var']
data_df_1.head()

# Current relevent runtime information:
{'__method__data_df_columns': {'type': '<class '
                                       "'pandas.core.indexes.base.Index'>"},
 '__method__data_df_loc': {'type': '<class '
                                   "'pandas.core.indexing._LocIndexer'>"},
 '__method__plt_figure': {'type': "<class 'function'>"},
 '__method__plt_show': {'type': "<class 'function'>"},
 '__method__plt_subplot': {'type': "<class 'function'>"},
 '__method__plt_subplots': {'type': "<class 'function'>"},
 '__method__plt_tick_params': {'type': "<class 'function'>"},
 '__method__plt_xlabel': {'type': "<class 'function'>"},
 '__method__plt_xticks': {'type': "<class 'function'>"},
 '__method__sns_kdeplot': {'type': "<class 'function'>"},
 '__method__sns_set_style': {'type': "<class 'function'>"},
 'data_df': {'execution_cell_source': {'cellno': 7, 'lineno': 1},
             'has_nan': False,
             'per_column': {'Amount': {'dtype': 'float64',
                                       'num_unique': 32767,
                                       'type': 'continuous',
                                       'value_range': (0.0, 25691.16)},
                            'Class': {'dtype': 'int64',
                                      'num_unique': 2,
                                      'type': 'binary',
                                      'value_range': (0, 1)},
                            'Hour': {'dtype': 'float64',
                                     'num_unique': 48,
                                     'type': 'continuous',
                                     'value_range': (0.0, 47.0)},
                            'Time': {'dtype': 'float64',
                                     'num_unique': 124592,
                                     'type': 'continuous',
                                     'value_range': (0.0, 172792.0)},
                            'V1': {'dtype': 'float64',
                                   'num_unique': 275663,
                                   'type': 'continuous',
                                   'value_range': (-56.407509631329,
                                                   2.45492999121121)},
                            'V10': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-24.5882624372475,
                                                    23.7451361206545)},
                            'V11': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-4.79747346479757,
                                                    12.0189131816199)},
                            'V12': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-18.6837146333443,
                                                    7.8483920756446)},
                            'V13': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-5.79188120632084,
                                                    7.12688295859376)},
                            'V14': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-19.2143254902614,
                                                    10.5267660517847)},
                            'V15': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-4.49894467676621,
                                                    8.87774159774277)},
                            'V16': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-14.1298545174931,
                                                    17.3151115176278)},
                            'V17': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-25.1627993693248,
                                                    9.25352625047285)},
                            'V18': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-9.49874592104677,
                                                    5.04106918541184)},
                            'V19': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-7.21352743017759,
                                                    5.59197142733558)},
                            'V2': {'dtype': 'float64',
                                   'num_unique': 275663,
                                   'type': 'continuous',
                                   'value_range': (-72.7157275629303,
                                                   22.0577289904909)},
                            'V20': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-54.497720494566,
                                                    39.4209042482199)},
                            'V21': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-34.8303821448146,
                                                    27.2028391573154)},
                            'V22': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-10.933143697655,
                                                    10.5030900899454)},
                            'V23': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-44.8077352037913,
                                                    22.5284116897749)},
                            'V24': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-2.83662691870341,
                                                    4.58454913689817)},
                            'V25': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-10.2953970749851,
                                                    7.51958867870916)},
                            'V26': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-2.60455055280817,
                                                    3.5173456116238)},
                            'V27': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-22.5656793207827,
                                                    31.6121981061363)},
                            'V28': {'dtype': 'float64',
                                    'num_unique': 275663,
                                    'type': 'continuous',
                                    'value_range': (-15.4300839055349,
                                                    33.8478078188831)},
                            'V3': {'dtype': 'float64',
                                   'num_unique': 275663,
                                   'type': 'continuous',
                                   'value_range': (-48.3255893623954,
                                                   9.38255843282114)},
                            'V4': {'dtype': 'float64',
                                   'num_unique': 275663,
                                   'type': 'continuous',
                                   'value_range': (-5.68317119816995,
                                                   16.8753440335975)},
                            'V5': {'dtype': 'float64',
                                   'num_unique': 275663,
                                   'type': 'continuous',
                                   'value_range': (-113.743306711146,
                                                   34.8016658766686)},
                            'V6': {'dtype': 'float64',
                                   'num_unique': 275663,
                                   'type': 'continuous',
                                   'value_range': (-26.1605059358433,
                                                   73.3016255459646)},
                            'V7': {'dtype': 'float64',
                                   'num_unique': 275663,
                                   'type': 'continuous',
                                   'value_range': (-43.5572415712451,
                                                   120.589493945238)},
                            'V8': {'dtype': 'float64',
                                   'num_unique': 275663,
                                   'type': 'continuous',
                                   'value_range': (-73.2167184552674,
                                                   20.0072083651213)},
                            'V9': {'dtype': 'float64',
                                   'num_unique': 275663,
                                   'type': 'continuous',
                                   'value_range': (-13.4340663182301,
                                                   15.5949946071278)}},
             'shape': (284807, 32),
             'type': 'pandas.core.frame.DataFrame'},
 'plt': {'type': "<class 'module'>"},
 'sns': {'type': "<class 'module'>"}}
# Target Cell:

var = data_df.columns.values

i = 0




t0 = data_df.loc[data_df['Class'] == 0]
t1 = data_df.loc[data_df['Class'] == 1]

sns.set_style('whitegrid')
plt.figure()
fig, ax = plt.subplots(8,4,figsize=(16,28))

for feature in var:
    i += 1
    plt.subplot(8,4,i)
    sns.kdeplot(t0[feature], bw=0.5,label="Class = 0");
    sns.kdeplot(t1[feature], bw=0.5,label="Class = 1");
    plt.xlabel(feature, fontsize=12)
    locs, labels = plt.xticks()
    plt.tick_params(axis='both', which='major', labelsize=12)
plt.show();