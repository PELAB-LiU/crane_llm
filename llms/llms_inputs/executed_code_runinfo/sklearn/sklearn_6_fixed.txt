# Executed Cells:
## Cell 1:





import numpy as np
import pandas as pd




import os
for dirname, _, filenames in os.walk('data'):
    for filename in filenames:
        print(os.path.join(dirname, filename))




## Cell 2:

import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score

## Cell 3:

train_ds = pd.read_csv("data/train.csv")
test_ds = pd.read_csv("data/test.csv")

## Cell 4:

train_ds.drop(['Id', 'MoSold', 'GarageYrBlt', 'Condition1', 'Condition2'], axis = 1, inplace = True)

## Cell 5:

for column in train_ds:
    null_count = train_ds[column].isnull().sum()
    if null_count > 1:
        print(f"Dropping column {column} with {null_count} missing values.")
        train_ds.drop(column, axis = 1, inplace = True)

## Cell 6:

le = LabelEncoder()
string_columns = train_ds.select_dtypes(include = ['object']).columns
for column in string_columns:
    train_ds[column] = le.fit_transform(train_ds[column])

## Cell 7:

X = train_ds.drop(['SalePrice'], axis = 1)
y = train_ds['SalePrice']

## Cell 8:

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 42)

## Cell 9:

from sklearn.ensemble import RandomForestRegressor
FReg = RandomForestRegressor(n_estimators = 100, random_state = 42)

## Cell 10:

FReg.fit(X_train, y_train)

## Cell 11:

y_pred = FReg.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
print(f'R2 Score: {r2}')
print(f'MSE: {mse}')

## Cell 12:

test_ds_ids = test_ds['Id']
test_ds.drop(['Id', 'MoSold', 'GarageYrBlt', 'Condition1', 'Condition2'], axis = 1, inplace = True)

## Cell 13:









test_ds = test_ds[X_train.columns]
for col in test_ds.columns:
    if test_ds[col].dtype == 'object':
        test_ds[col] = test_ds[col].fillna("")
    elif pd.api.types.is_numeric_dtype(test_ds[col]):
        test_ds[col] = test_ds[col].fillna(0)

## Cell 14:

le = LabelEncoder()
string_columns = test_ds.select_dtypes(include = ['object']).columns
for column in string_columns:
    test_ds[column] = le.fit_transform(test_ds[column])

# Current relevent runtime information:
{'FReg': {'class_name': 'RandomForestRegressor',
          'execution_cell_source': {'cellno': 33, 'lineno': 2},
          'fitted_attributes': {'n_features_in_': 58, 'n_outputs_': 1},
          'is_fitted': True,
          'module': 'sklearn.ensemble._forest',
          'type': "<class 'sklearn.ensemble._forest.RandomForestRegressor'>"},
 '__method__FReg_predict': {'type': "<class 'method'>"},
 '__method__pd_DataFrame': {'type': "<class 'type'>"},
 'pd': {'type': "<class 'module'>"},
 'test_ds': {'execution_cell_source': {'cellno': 42, 'lineno': 9},
             'has_nan': False,
             'per_column': {'1stFlrSF': {'num_unique': 789,
                                         'type': 'continuous',
                                         'value_range': (407, 5095)},
                            '2ndFlrSF': {'num_unique': 407,
                                         'type': 'continuous',
                                         'value_range': (0, 1862)},
                            '3SsnPorch': {'num_unique': 13,
                                          'type': 'continuous',
                                          'value_range': (0, 360)},
                            'BedroomAbvGr': {'num_unique': 7,
                                             'type': 'categorical_numeric',
                                             'value_range': (0, 6)},
                            'BldgType': {'num_unique': 5,
                                         'type': 'categorical_numeric',
                                         'value_range': (0, 4)},
                            'BsmtFinSF1': {'num_unique': 669,
                                           'type': 'continuous',
                                           'value_range': (0.0, 4010.0)},
                            'BsmtFinSF2': {'num_unique': 161,
                                           'type': 'continuous',
                                           'value_range': (0.0, 1526.0)},
                            'BsmtFullBath': {'num_unique': 4,
                                             'type': 'continuous',
                                             'value_range': (0.0, 3.0)},
                            'BsmtHalfBath': {'num_unique': 3,
                                             'type': 'continuous',
                                             'value_range': (0.0, 2.0)},
                            'BsmtUnfSF': {'num_unique': 793,
                                          'type': 'continuous',
                                          'value_range': (0.0, 2140.0)},
                            'CentralAir': {'num_unique': 2,
                                           'type': 'binary',
                                           'value_range': (0, 1)},
                            'Electrical': {'num_unique': 4,
                                           'type': 'categorical_numeric',
                                           'value_range': (0, 3)},
                            'EnclosedPorch': {'num_unique': 131,
                                              'type': 'continuous',
                                              'value_range': (0, 1012)},
                            'ExterCond': {'num_unique': 5,
                                          'type': 'categorical_numeric',
                                          'value_range': (0, 4)},
                            'ExterQual': {'num_unique': 4,
                                          'type': 'categorical_numeric',
                                          'value_range': (0, 3)},
                            'Exterior1st': {'num_unique': 14,
                                            'type': 'continuous',
                                            'value_range': (0, 13)},
                            'Exterior2nd': {'num_unique': 16,
                                            'type': 'continuous',
                                            'value_range': (0, 15)},
                            'Fireplaces': {'num_unique': 5,
                                           'type': 'categorical_numeric',
                                           'value_range': (0, 4)},
                            'Foundation': {'num_unique': 6,
                                           'type': 'categorical_numeric',
                                           'value_range': (0, 5)},
                            'FullBath': {'num_unique': 5,
                                         'type': 'categorical_numeric',
                                         'value_range': (0, 4)},
                            'Functional': {'num_unique': 8,
                                           'type': 'categorical_numeric',
                                           'value_range': (0, 7)},
                            'GarageArea': {'num_unique': 459,
                                           'type': 'continuous',
                                           'value_range': (0.0, 1488.0)},
                            'GarageCars': {'num_unique': 6,
                                           'type': 'continuous',
                                           'value_range': (0.0, 5.0)},
                            'GrLivArea': {'num_unique': 879,
                                          'type': 'continuous',
                                          'value_range': (407, 5095)},
                            'HalfBath': {'num_unique': 3,
                                         'type': 'categorical_numeric',
                                         'value_range': (0, 2)},
                            'Heating': {'num_unique': 4,
                                        'type': 'categorical_numeric',
                                        'value_range': (0, 3)},
                            'HeatingQC': {'num_unique': 5,
                                          'type': 'categorical_numeric',
                                          'value_range': (0, 4)},
                            'HouseStyle': {'num_unique': 7,
                                           'type': 'categorical_numeric',
                                           'value_range': (0, 6)},
                            'KitchenAbvGr': {'num_unique': 3,
                                             'type': 'categorical_numeric',
                                             'value_range': (0, 2)},
                            'KitchenQual': {'num_unique': 5,
                                            'type': 'categorical_numeric',
                                            'value_range': (0, 4)},
                            'LandContour': {'num_unique': 4,
                                            'type': 'categorical_numeric',
                                            'value_range': (0, 3)},
                            'LandSlope': {'num_unique': 3,
                                          'type': 'categorical_numeric',
                                          'value_range': (0, 2)},
                            'LotArea': {'num_unique': 1106,
                                        'type': 'continuous',
                                        'value_range': (1470, 56600)},
                            'LotConfig': {'num_unique': 5,
                                          'type': 'categorical_numeric',
                                          'value_range': (0, 4)},
                            'LotShape': {'num_unique': 4,
                                         'type': 'categorical_numeric',
                                         'value_range': (0, 3)},
                            'LowQualFinSF': {'num_unique': 15,
                                             'type': 'continuous',
                                             'value_range': (0, 1064)},
                            'MSSubClass': {'num_unique': 16,
                                           'type': 'continuous',
                                           'value_range': (20, 190)},
                            'MSZoning': {'num_unique': 6,
                                         'type': 'categorical_numeric',
                                         'value_range': (0, 5)},
                            'MiscVal': {'num_unique': 26,
                                        'type': 'continuous',
                                        'value_range': (0, 17000)},
                            'Neighborhood': {'num_unique': 25,
                                             'type': 'continuous',
                                             'value_range': (0, 24)},
                            'OpenPorchSF': {'num_unique': 203,
                                            'type': 'continuous',
                                            'value_range': (0, 742)},
                            'OverallCond': {'num_unique': 9,
                                            'type': 'categorical_numeric',
                                            'value_range': (1, 9)},
                            'OverallQual': {'num_unique': 10,
                                            'type': 'categorical_numeric',
                                            'value_range': (1, 10)},
                            'PavedDrive': {'num_unique': 3,
                                           'type': 'categorical_numeric',
                                           'value_range': (0, 2)},
                            'PoolArea': {'num_unique': 7,
                                         'type': 'categorical_numeric',
                                         'value_range': (0, 800)},
                            'RoofMatl': {'num_unique': 4,
                                         'type': 'categorical_numeric',
                                         'value_range': (0, 3)},
                            'RoofStyle': {'num_unique': 6,
                                          'type': 'categorical_numeric',
                                          'value_range': (0, 5)},
                            'SaleCondition': {'num_unique': 6,
                                              'type': 'categorical_numeric',
                                              'value_range': (0, 5)},
                            'SaleType': {'num_unique': 10,
                                         'type': 'categorical_numeric',
                                         'value_range': (0, 9)},
                            'ScreenPorch': {'num_unique': 75,
                                            'type': 'continuous',
                                            'value_range': (0, 576)},
                            'Street': {'num_unique': 2,
                                       'type': 'binary',
                                       'value_range': (0, 1)},
                            'TotRmsAbvGrd': {'num_unique': 12,
                                             'type': 'continuous',
                                             'value_range': (3, 15)},
                            'TotalBsmtSF': {'num_unique': 736,
                                            'type': 'continuous',
                                            'value_range': (0.0, 5095.0)},
                            'Utilities': {'num_unique': 2,
                                          'type': 'binary',
                                          'value_range': (0, 1)},
                            'WoodDeckSF': {'num_unique': 263,
                                           'type': 'continuous',
                                           'value_range': (0, 1424)},
                            'YearBuilt': {'num_unique': 106,
                                          'type': 'continuous',
                                          'value_range': (1879, 2010)},
                            'YearRemodAdd': {'num_unique': 61,
                                             'type': 'continuous',
                                             'value_range': (1950, 2010)},
                            'YrSold': {'num_unique': 5,
                                       'type': 'categorical_numeric',
                                       'value_range': (2006, 2010)}},
             'shape': (1459, 58),
             'type': 'pandas.core.frame.DataFrame'},
 'test_ds_ids': {'dtype': 'int64',
                 'execution_cell_source': {'cellno': 40, 'lineno': 1},
                 'has_nan': False,
                 'length': 1459,
                 'type': 'pandas.core.series.Series',
                 'value_info': {'value_range': (1461, 2919),
                                'value_type': 'continuous'}}}
# Target Cell:

predictions = FReg.predict(test_ds)
submissions_df = pd.DataFrame({
    "ID" : test_ds_ids,
    "Predictions" : predictions
})

